title: 解析XML-广度优先算法
date: 2016-01-18
tags: 
    - xml
categories: 编程

---


## 解析XML（广度优先算法）

有一个地址的需求,需要设计一个能够快速找到医院所在省，市的方法（本文中忽略第四级医院的查询），由于所有数据加起来有1.7W条，所以采用的是广度优先的解析方式来加快前台页面结果显示。

如下面一段xml表格:

```xml
<g id="11" name="中国">
    <p id="01" name="北京">
        <c id="01" name="朝阳">
        <c id="02" name="海淀">
    </p>
    <p id="02" name="天津">
        <c id="01" name="南开">
        <c id="02" name="河西">
    </p>
</g>
```
目标: 我需要找到`南开`:

- 普通查询: 中国 -> 北京 -> 朝阳 -> 海淀 -> 天津 -> 南开

- 我想要的查询路径: 中国 -> 天津 -> 南开

如何才能做的到呢,这时候就用到了id这个属性,我所查询的河西等于110201的编号。既定的存储规则为国家11-99标示,站字节前两位;省为0-99区间,占中间两位;市站后面两位0-99的规则。

此时我查询的步骤:
    - 查询所有国家中id为11的国家找到中国
    - 查询`中国`下面所有`id`为`02`的省,得到`天津`
    - 查询天津下面`id`为02的市区,得到`南开`。

先查一级目录,然后二级目录,三级目录...

可以通过 new DOMParser将xml解析为DOM结构:

```
var code = "110201"
var dom = '<g id="11" name="中国"><p id="01" name="北京"><c id="01" name="朝阳"><c id="02" name="海淀"></p><p id="02" name="天津"><c id="01" name="南开"><c id="02" name="河西"></p></g>',
    parser = new DOMParser(),
    doc = parser.parseFromString(dom, "text/xml");

```

再通过getAttribute,getElementsByTagName来循环遍历找到"110201"对应的省市区